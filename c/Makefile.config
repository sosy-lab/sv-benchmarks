# Copyright (c) 2015 Daniel Liew <dan@su-root.co.uk>
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# Compiler to use unless overriden

################################################################################
# Note when defaults are set here (i.e. ``?=``) this can be overriden if three
# different ways.
#
# * From the command line by passing an argument to make, e.g.
#   ```
#   $ make CC=clang
#   ```
# * By setting an environment variable, e.g.
#   ```
#   $ export CC=clang
#   $ make
#   ```
# * By setting the value in a top level makefile. For example one could add
#   the line ``CC := clang`` to ``array-examples/Makefile``. This method should
#   be used when you permanently want change use something other than the
#   default specified in this file for all sources in a directory.
################################################################################

################################################################################
# Set default C Compiler
################################################################################
CC ?= gcc

################################################################################
# Append to C compiler flags.
# It is important to append so that it is posible to set CC.Flags in a top-level
# makefile.
################################################################################
CC.Flags += -x c

################################################################################
# Set default x86 architecture variant
# Valid values are 32 and 64.
################################################################################
CC.Arch ?= 32

################################################################################
# Set default C standard if
# Valid values are accepted arguments to gcc's ``-std=`` command line argument.
################################################################################
CC.Standard ?=c99

################################################################################
# Build directory relative to the the ``c`` directory (i.e. the directory
# containing ``Makefile.config``). All files generated by the build live under
# this directory
################################################################################
BUILD_DIR := bin

################################################################################
# Set default behaviour regarding emission of LLVM Bitcode rather than native
# object files
################################################################################
EMIT_LLVM ?= 0

################################################################################
# Set default behaviour for treating compiler warnings as errors.
# Valid values are 0 (off) and 1 (on)
################################################################################
WARNINGS_AS_ERRORS ?= 0

################################################################################
# Warning flags to be passed to clang and gcc (i.e. flags are supported by both
# compilers).
#
# FIXME: Use of each -Wno-* flag NEEDS TO BE JUSTIFIED
################################################################################
COMMON_WARNINGS := -Wall \
                   -Wno-unused-label \
                   -Wno-unused-function \
                   -Wno-unused-variable \
                   -Wno-unused-value \
                   -Wno-unknown-pragmas \
                   -Wno-attributes \
                   -Wno-parentheses \
                   -Wno-uninitialized \
                   -Wno-pointer-to-int-cast \
                   -Wno-int-to-pointer-cast \
                   -Wno-pointer-sign \
                   -Wno-return-type \
                   -Wno-main \
                   -Wno-sequence-point \

################################################################################
# Warning flags that will only be passed to gcc
# FIXME: Use of each -Wno-* flag NEEDS TO BE JUSTIFIED
################################################################################
GCC_ONLY_WARNINGS := -Wno-unused-but-set-variable \
                     -Wno-maybe-uninitialized \
                     -Wno-return-local-addr

################################################################################
# Warning flags that will only be passed to clang
################################################################################
CLANG_ONLY_WARNINGS :=

################################################################################
# Variables for various command line tools
################################################################################
RM := rm
MKDIR := mkdir
GREP := grep
include $(LEVEL)/Makefile.rules
